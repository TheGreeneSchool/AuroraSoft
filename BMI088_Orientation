#include "BMI088.h"
Bmi088Accel accel(Wire, 0x18);
Bmi088Gyro gyro(Wire, 0x68);


//ALL VARS

double OreX, OreY, OreZ;
double PreviousGyroX, PreviousGyroY, PreviousGyroZ, IntGyroX, IntGyroY, RADGyroX, RADGyroY, RADGyroZ, RawGyZ, DifferenceGyroX, DifferenceGyroY, DifferenceGyroZ, matrix1, matrix2, matrix3;
double matrix4, matrix5, matrix6, matrix7, matrix8, matrix9, PrevGyX, PrevGyY, PrevGyZ, RawGyX, RawGyY, GyroAngleX, GyroAngleY, GyroAngleZ, GyroRawX, GyroRawY, GyroRawZ;
double OrientationX = 0;
double OrientationY = 0;
double OrientationZ = 1;
double Ax;
double Ay;
double Az;
double dt, currentTime, previousTime;
//END






void setup()
{
  int status;
  /* USB Serial to print data */
  Serial.begin(9600);
  while (!Serial) {}
  /* start the sensors */
  status = accel.begin();
  if (status < 0) {
    Serial.println("Accel Initialization Error");
    Serial.println(status);
    while (1) {}
  }
  status = gyro.begin();
  if (status < 0) {
    Serial.println("Gyro Initialization Error");
    Serial.println(status);
    while (1) {}
  }
}

void loop()
{
  accel.readSensor();
  gyro.readSensor();
  currentTime = millis();            
  dt = (currentTime - previousTime) / 1000;
  getAngle();
  previousTime = currentTime;  

}

void getAngle(){
    //Change Variable so its easier to refrence later on
  GyroRawX = (gyro.getGyroY_rads());
  GyroRawY = (gyro.getGyroZ_rads());
  GyroRawZ = (gyro.getGyroX_rads());

  //Integrate over time to get Local Orientation
  GyroAngleX += (GyroRawX * dt)*60;
  GyroAngleY += (GyroRawY * dt)*60;
  GyroAngleZ += (GyroRawZ * dt)*60;

  Serial.print(GyroAngleX);
  Serial.print(",");
  Serial.print(GyroAngleY);
  Serial.print(",");
  Serial.println(GyroAngleZ);
 
}








